@page
@using SAAS_Projectplanningtool.Pages.Projects
@model SAAS_Projectplanningtool.Pages.Projects.EditModel
@{
    ViewData["Title"] = "Projektterminplanung - " + Model.Project?.ProjectName;
}

<div class="container-fluid">
    <div class="row mb-3">
        <div class="col">
            <h2>@ViewData["Title"]</h2>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a asp-page="./Index">Projekte</a></li>
                    <li class="breadcrumb-item active">Terminplanung</li>
                </ol>
            </nav>
        </div>
    </div>
    <!--  Feedbackhandling (should only be displayed for certain amount of seconds)-->
    @{
        var message = TempData.GetMessage();
    }
    @if (message != null)
    {
        <div class="alert alert-@message.Type.ToLower()" id="feedback-message">
            @message.Message
        </div>

        <script>
            setTimeout(function () {
                var msg = document.getElementById('feedback-message');
                if (msg) {
                    msg.style.transition = "opacity 0.5s ease";
                    msg.style.opacity = 0;
                    setTimeout(() => msg.remove(), 500); // Remove after fade
                }
            }, 3000); // Display for 3 seconds
        </script>
    }

    <!-- Toolbar -->
    <div class="row mb-3">
        <div class="col">
            <div class="btn-group" role="group">
                <button type="button" class="btn btn-primary" onclick="showAddSectionModal()">
                    <i class="fas fa-plus"></i> Abschnitt hinzufügen
                </button>
                <button type="button" class="btn btn-secondary" onclick="showAddTaskModal()">
                    <i class="fas fa-tasks"></i> Aufgabe hinzufügen
                </button>
                <button type="button" class="btn btn-info" onclick="toggleViewMode()">
                    <i class="fas fa-eye"></i> Ansicht wechseln
                </button>
                <button type="button" class="btn btn-warning" onclick="zoomToFit()">
                    <i class="fas fa-search"></i> Anpassen
                </button>
            </div>
        </div>
    </div>

    <!-- Gantt Chart Container -->
    <div class="row">
        <div class="col">
            <div class="card" style="margin-bottom:80px;">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Gantt-Diagramm</h5>
                    <div class="btn-group btn-group-sm">
                        <button type="button" class="btn btn-outline-secondary" onclick="changeTimeScale('day')">Tag</button>
                        <button type="button" class="btn btn-outline-secondary active" onclick="changeTimeScale('week')">Woche</button>
                        <button type="button" class="btn btn-outline-secondary" onclick="changeTimeScale('month')">Monat</button>
                    </div>
                </div>
                <div class="card-body p-0">
                    @* <div id="gantt-container" style="height: 600px; overflow: hidden;"> *@
                    <div id="gantt-container">
                        <div class="gantt-wrapper">
                            <!-- Task List Panel -->
                            <div class="gantt-task-list">
                                <div class="gantt-header">
                                    <div class="task-name-header">Aufgabe</div>
                                    <div class="task-duration-header">Dauer</div>
                                    <div class="task-start-header">Start</div>
                                    <div class="task-end-header">Ende</div>
                                    <div class="task-actions-header">Aktionen</div>
                                </div>
                                <div id="task-list-body" class="gantt-task-list-body">
                                    <!-- Tasks will be populated here -->
                                </div>
                            </div>

                            <!-- Timeline Panel -->
                            <div class="gantt-timeline">
                                <div id="timeline-header" class="gantt-timeline-header">
                                    <!-- Timeline header will be generated -->
                                </div>
                                <div id="timeline-body" class="gantt-timeline-body">
                                    <!-- Timeline bars will be generated -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Partial Modals for ProjectHandling -->
@await Html.PartialAsync("~/Pages/Projects/Modals/_AddSubSectionModal.cshtml", Model)
@await Html.PartialAsync("~/Pages/Projects/Modals/_AddSectionModal.cshtml", Model)
@await Html.PartialAsync("~/Pages/Projects/Modals/_AddItemModal.cshtml", Model)
@await Html.PartialAsync("~/Pages/Projects/Modals/_EditTaskModal.cshtml", Model)
@await Html.PartialAsync("~/Pages/Projects/Modals/_AddTaskModal.cshtml", Model)
@await Html.PartialAsync("~/Pages/Projects/Modals/_DeleteConfirmationModal.cshtml", Model)



<!-- Include Bootstrap and FontAwesome if not already included -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="/css/gantt.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<script src="~/js/ProjectSchedulingGantt.js"></script>
<script src="~/js/ModalFunctions.js"></script>
